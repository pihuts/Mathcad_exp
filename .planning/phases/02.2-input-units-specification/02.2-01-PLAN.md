---
phase: 02.2-input-units-specification
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [src/engine/protocol.py]
autonomous: true

must_haves:
  truths:
    - "InputConfig dataclass exists with alias, value, and units fields"
    - "InputConfig can be imported from engine.protocol module"
    - "Type hints are correctly specified for all fields"
  artifacts:
    - path: "src/engine/protocol.py"
      provides: "InputConfig dataclass for units-aware input specification"
      contains: "class InputConfig"
      min_lines: 5
  key_links:
    - from: "worker.py"
      to: "protocol.py"
      via: "from engine.protocol import InputConfig"
      pattern: "from.*protocol.*import.*InputConfig"
---

<objective>
Add InputConfig dataclass to support units specification in batch calculations.

Purpose: Provide a structured, type-safe way to pass input values with optional units through the batch processing pipeline.
Output: InputConfig dataclass in protocol.py that can be imported by worker, harness, and batch_manager.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02.2-input-units-specification/02.2-RESEARCH.md

@src/engine/protocol.py
@src/engine/worker.py
@src/engine/harness.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add InputConfig dataclass to protocol.py</name>
  <files>src/engine/protocol.py</files>
  <action>
Add InputConfig dataclass to protocol.py after the JobResult class (around line 28):

```python
@dataclass
class InputConfig:
    """Configuration for a single input in a batch calculation"""
    alias: str
    value: Any
    units: Optional[str] = None  # Units specification (e.g., "in", "ft", "kip", or None for default)
```

This provides:
- Type-safe structure for input configuration with units
- Optional units field (defaults to None for worksheet default behavior)
- Clear documentation of purpose

Why this location: protocol.py already contains JobRequest and JobResult dataclasses, so InputConfig belongs here as a shared data structure.
</action>
  <verify>
Verify that:
1. File compiles: `python -c "from engine.protocol import InputConfig; ic = InputConfig('L', 10, 'ft'); print(ic)"`
2. Type hints are correct: InputConfig.alias is str, InputConfig.value is Any, InputConfig.units is Optional[str]
3. Defaults work: InputConfig('L', 10) creates instance with units=None
</verify>
  <done>InputConfig dataclass added to protocol.py and successfully imported in verification command</done>
</task>

</tasks>

<verification>
After completing this plan, verify:
- InputConfig can be imported from engine.protocol
- InputConfig creates valid instances with and without units parameter
- No syntax errors in protocol.py
</verification>

<success_criteria>
1. InputConfig dataclass exists with correct signature (alias, value, units)
2. Units field is Optional[str] with None as default
3. Python can import and instantiate InputConfig without errors
</success_criteria>

<output>
After completion, create `.planning/phases/02.2-input-units-specification/02.2-01-SUMMARY.md`
</output>
