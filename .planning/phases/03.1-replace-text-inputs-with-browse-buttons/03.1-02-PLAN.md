---
phase: 03.1-replace-text-inputs-with-browse-buttons
plan: 02
type: execute
wave: 2
depends_on: ["03.1-01"]
files_modified:
  - frontend/src/App.tsx
  - frontend/src/components/WorkflowBuilder.tsx
  - frontend/src/services/api.ts
autonomous: true

must_haves:
  truths:
    - "Batch processing tab has Browse button instead of text input for file path"
    - "Workflow Builder has Browse button for each file entry"
    - "Clicking Browse opens native Windows file dialog"
    - "Selected file path displays next to Browse button"
    - "Users can still see the selected file name"
  artifacts:
    - path: "frontend/src/services/api.ts"
      provides: "browseFile API function"
      contains: "export const browseFile"
    - path: "frontend/src/App.tsx"
      provides: "Browse button in batch tab"
      contains: "browseFile"
    - path: "frontend/src/components/WorkflowBuilder.tsx"
      provides: "Browse button per workflow file"
      contains: "browseFile"
  key_links:
    - from: "frontend/src/App.tsx"
      to: "frontend/src/services/api.ts"
      via: "import browseFile"
      pattern: "browseFile\\(\\)"
    - from: "frontend/src/components/WorkflowBuilder.tsx"
      to: "frontend/src/services/api.ts"
      via: "import browseFile"
      pattern: "browseFile\\(\\)"
---

<objective>
Replace text inputs with browse buttons in frontend components

Purpose: Provide intuitive file selection UX by replacing manual path typing with native file browser dialogs triggered via backend endpoint.

Output: Browse buttons in both Batch Processing tab and Workflow Builder that trigger native file dialogs and display selected paths.
</objective>

<execution_context>
@C:\Users\peter\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\peter\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03.1-replace-text-inputs-with-browse-buttons/03.1-RESEARCH.md
@.planning/phases/03.1-replace-text-inputs-with-browse-buttons/03.1-01-SUMMARY.md

@frontend/src/services/api.ts
@frontend/src/App.tsx
@frontend/src/components/WorkflowBuilder.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add browseFile API function</name>
  <files>frontend/src/services/api.ts</files>
  <action>
Add a new API function to call the backend browse endpoint:

```typescript
export const browseFile = async (): Promise<{ file_path: string | null; cancelled: boolean }> => {
  const response = await api.post('/files/browse');
  return response.data;
};
```

Place this with other API functions (after getInputs or similar).
  </action>
  <verify>
TypeScript compiles without errors: `cd D:\Mathcad_exp\frontend && npm run build`
  </verify>
  <done>
browseFile function exported from api.ts and calls POST /api/v1/files/browse
  </done>
</task>

<task type="auto">
  <name>Task 2: Replace batch file TextInput with Browse button</name>
  <files>frontend/src/App.tsx</files>
  <action>
Replace the TextInput for "Mathcad File Path" (around line 226-231) with a Browse button and path display:

1. Add import: `import { browseFile } from './services/api'`
2. Add IconFile import: `import { IconFile } from '@tabler/icons-react'` (add to existing icon imports)

3. Replace the TextInput section with:
```tsx
<Group align="flex-end">
  <Stack gap="xs" style={{ flex: 1 }}>
    <Text size="sm" fw={500}>Mathcad File Path</Text>
    <Group gap="xs">
      <Button
        leftSection={<IconFile size={16} />}
        onClick={async () => {
          const result = await browseFile();
          if (!result.cancelled && result.file_path) {
            setFilePath(result.file_path);
          }
        }}
      >
        Browse
      </Button>
      {filePath && (
        <Text size="sm" c="dimmed" truncate style={{ flex: 1 }} title={filePath}>
          {filePath.split('\\').pop()}
        </Text>
      )}
    </Group>
  </Stack>
  <Button
    onClick={handleAnalyze}
    loading={isAnalyzing}
    disabled={isAnalyzing || !filePath}
  >
    Analyze File
  </Button>
</Group>
```

Key changes:
- Remove TextInput, add Browse button
- Show just filename (with full path in title tooltip)
- Keep Analyze button adjacent
  </action>
  <verify>
1. `cd D:\Mathcad_exp\frontend && npm run build` succeeds
2. Start app and verify Browse button appears in Batch Processing tab
3. Click Browse, select file, verify path is captured and filename displayed
  </verify>
  <done>
Batch Processing tab has Browse button that opens native dialog and displays selected filename
  </done>
</task>

<task type="auto">
  <name>Task 3: Replace WorkflowBuilder TextInput with Browse button</name>
  <files>frontend/src/components/WorkflowBuilder.tsx</files>
  <action>
Replace the TextInput for workflow file paths (around line 127-132) with a Browse button:

1. Add import: `import { browseFile } from '../services/api'`
2. Add IconFile import: `import { IconFile } from '@tabler/icons-react'` (add to existing icon imports)

3. Replace the TextInput section inside each workflow file row with:
```tsx
<Group gap="xs">
  <Badge size="xs" color="blue">
    {index + 1}
  </Badge>
  <Button
    size="xs"
    variant="light"
    leftSection={<IconFile size={14} />}
    onClick={async () => {
      const result = await browseFile();
      if (!result.cancelled && result.file_path) {
        handleUpdateFilePath(index, result.file_path);
      }
    }}
  >
    Browse
  </Button>
  {file.file_path && (
    <Text size="xs" c="dimmed" truncate style={{ flex: 1 }} title={file.file_path}>
      {file.file_path.split('\\').pop()}
    </Text>
  )}
</Group>
```

Key changes:
- Remove TextInput placeholder
- Add compact Browse button with file icon
- Show filename with tooltip for full path
- Keep existing drag handle behavior
  </action>
  <verify>
1. `cd D:\Mathcad_exp\frontend && npm run build` succeeds
2. Start app, go to Workflow tab
3. Add a new file, click Browse, verify native dialog opens
4. Select file, verify path captured and filename displayed
5. Verify drag-and-drop still works
  </verify>
  <done>
WorkflowBuilder has Browse button per file that opens native dialog and displays selected filename
  </done>
</task>

</tasks>

<verification>
1. Frontend builds without TypeScript errors
2. Batch Processing tab: Browse button opens native dialog, shows filename after selection
3. Workflow tab: Each file row has Browse button, opens dialog, shows filename
4. Drag-and-drop reordering still works in Workflow tab
5. Analyze File button still works after Browse selection
6. No console errors in browser
</verification>

<success_criteria>
- Both file inputs replaced with Browse buttons
- Native Windows dialog opens on Browse click
- Selected file paths stored correctly in state
- Filenames displayed (not full paths) for cleaner UI
- Full paths shown in tooltips
- Existing functionality (Analyze, Run, drag-drop) preserved
</success_criteria>

<output>
After completion, create `.planning/phases/03.1-replace-text-inputs-with-browse-buttons/03.1-02-SUMMARY.md`
</output>
